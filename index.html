<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Malla Interactiva - Ingeniería en Minas</title>
  <style>
    body {
      font-family: sans-serif;
      background: #e8dfd5;
      margin: 0;
      padding: 20px;
    }
    h1 {
      text-align: center;
      color: #3a3a3a;
    }
    .contenedor {
      display: flex;
      gap: 10px;
      overflow-x: auto;
      padding: 20px;
    }
    .columna {
      flex: 0 0 auto;
      min-width: 180px;
      background: #f1eae0;
      border-radius: 10px;
      padding: 10px;
    }
    .columna h2 {
      text-align: center;
      font-size: 1em;
      color: #4a4a4a;
    }
    .materia {
      background: #d9d9c9;
      border-radius: 20px;
      margin: 6px 0;
      padding: 10px;
      text-align: center;
      cursor: pointer;
      font-size: 0.9em;
      transition: background 0.3s, transform 0.2s;
    }
    .materia:hover {
      transform: scale(1.02);
    }
    .aprobada {
      background: #b4e1b4;
      text-decoration: line-through;
    }
    .desbloqueada {
      background: #fff2aa;
    }
    .bloqueada {
      background: #cccccc;
      opacity: 0.6;
      cursor: not-allowed;
    }
    .boton-reiniciar {
      margin: 20px auto;
      display: block;
      padding: 10px 20px;
      background: #a67c52;
      color: white;
      border: none;
      border-radius: 10px;
      cursor: pointer;
    }
  </style>
</head>
<body>

<h1>Malla Curricular - Ingeniería en Minas</h1>
<button class="boton-reiniciar" onclick="reiniciarProgreso()">Reiniciar progreso</button>
<div class="contenedor" id="malla"></div>

<script>
  const materias = [
    { nombre: "Álgebra I", id: "algebra1", columna: "1A", requisitos: [] },
    { nombre: "Cálculo I", id: "calculo1", columna: "1A", requisitos: [] },
    { nombre: "Fund. de la Programación", id: "fund_prog", columna: "1A", requisitos: [] },
    { nombre: "Intro a la Ingeniería", id: "intro", columna: "1A", requisitos: [] },
    { nombre: "Química", id: "quimica", columna: "1B", requisitos: [] },
    { nombre: "Álgebra II", id: "algebra2", columna: "1B", requisitos: ["algebra1"] },
    { nombre: "Física I", id: "fisica1", columna: "1B", requisitos: ["calculo1"] },
    { nombre: "Inglés", id: "ingles", columna: "2A", requisitos: [] },
    { nombre: "Cálculo II", id: "calculo2", columna: "2A", requisitos: ["calculo1"] },
    { nombre: "Física II", id: "fisica2", columna: "2A", requisitos: ["fisica1"] },
    { nombre: "Sist. de Representación", id: "sist_repr", columna: "2A", requisitos: ["algebra1"] },
    { nombre: "Geo. para Ingeniería", id: "geo", columna: "2B", requisitos: ["intro"] },
    { nombre: "Estática y Resist. Mat.", id: "estatica", columna: "2B", requisitos: ["calculo1", "fisica1"] },
    { nombre: "Electrotecnia", id: "electro", columna: "2B", requisitos: ["fisica1", "fisica2"] },
    { nombre: "Química Analítica", id: "quimica_a", columna: "2B", requisitos: ["quimica"] },
    { nombre: "Mec. Aplicada Minera", id: "mec_min", columna: "3A", requisitos: ["algebra2", "estatica"] },
    { nombre: "Prob. y Estadística", id: "estadistica", columna: "3A", requisitos: ["calculo2"] },
    { nombre: "Mineralogía", id: "mineralogia", columna: "3A", requisitos: ["geo"] },
    { nombre: "Construcciones", id: "construcciones", columna: "3A", requisitos: ["estatica"] },
    { nombre: "Mecánica de Rocas", id: "mec_rocas", columna: "3A", requisitos: ["geo", "estatica"] },
    { nombre: "Tratamiento Min. I", id: "trat1", columna: "3B", requisitos: ["quimica_a", "mineralogia", "mec_min"] },
    { nombre: "Mod. Matemáticos", id: "modelos", columna: "3B", requisitos: ["algebra2", "calculo2"] },
    { nombre: "Geoestadística", id: "geoestad", columna: "3B", requisitos: ["geo", "estadistica"] },
    { nombre: "Tec. de Explosivos", id: "explosivos", columna: "3B", requisitos: ["mec_rocas"] },
    { nombre: "Fund. de Laboreo", id: "laboreo", columna: "3B", requisitos: ["mec_rocas"] },
    { nombre: "Simulación Minera", id: "simulacion", columna: "4A", requisitos: ["fund_prog", "estadistica", "laboreo"] },
    { nombre: "Software Minero", id: "software", columna: "4A", requisitos: ["fund_prog", "laboreo"] },
    { nombre: "Máquinas y Servicios", id: "maquinas", columna: "4A", requisitos: ["mec_min", "laboreo"] },
    { nombre: "Tratamiento Min. II", id: "trat2", columna: "4A", requisitos: ["trat1"] },
    { nombre: "Petrografía", id: "petrografia", columna: "4A", requisitos: ["mineralogia"] },
    { nombre: "Perforaciones", id: "perforaciones", columna: "4B", requisitos: ["mec_rocas", "explosivos"] },
    { nombre: "Medio Ambiente", id: "medioamb", columna: "4B", requisitos: ["laboreo", "trat1"] },
    { nombre: "Exploración y Eval.", id: "exploracion", columna: "4B", requisitos: ["geoestad", "petrografia", "software"] },
    { nombre: "Eval. Económica", id: "evaleco", columna: "4B", requisitos: ["estadistica", "modelos"] },
    { nombre: "Topografía", id: "topografia", columna: "4B", requisitos: ["sist_repr", "laboreo"] },
    { nombre: "Seguridad y Salud", id: "seguridad", columna: "5A", requisitos: ["medioamb"] },
    { nombre: "Diseño de Plantas", id: "plantas", columna: "5A", requisitos: ["trat2"] },
    { nombre: "Legislación Minera", id: "legislacion", columna: "5A", requisitos: ["topografia"] },
    { nombre: "Proyecto Minero", id: "proyecto", columna: "5A", requisitos: ["software", "evaleco"] },
    { nombre: "Metalurgia Ext.", id: "metalurgia", columna: "5A", requisitos: ["trat2"] },
    { nombre: "Responsabilidad Soc.", id: "rsocial", columna: "5B", requisitos: ["legislacion"] },
    { nombre: "Gestión Organizacional", id: "gestion", columna: "5B", requisitos: ["seguridad"] },
    { nombre: "Ing. en Excavaciones", id: "excavaciones", columna: "5B", requisitos: ["explosivos", "maquinas", "proyecto"] },
    { nombre: "Proyecto Metalúrgico", id: "metalurgico", columna: "5B", requisitos: ["plantas", "proyecto"] },
    { nombre: "TIF", id: "tif", columna: "5B", requisitos: ["proyecto"] },
    { nombre: "Fund. de Admin. y Gestión", id: "admgestion", columna: "5B", requisitos: ["evaleco"] }
  ];

  const columnas = ["1A", "1B", "2A", "2B", "3A", "3B", "4A", "4B", "5A", "5B"];
  const aprobadas = JSON.parse(localStorage.getItem('materias_aprobadas')) || [];

  function guardarProgreso() {
    localStorage.setItem('materias_aprobadas', JSON.stringify(aprobadas));
  }

  function reiniciarProgreso() {
    localStorage.removeItem('materias_aprobadas');
    location.reload();
  }

  function crearMalla() {
    const malla = document.getElementById('malla');
    malla.innerHTML = "";
    const colMap = {};

    columnas.forEach(col => {
      const div = document.createElement('div');
      div.className = "columna";
      div.innerHTML = `<h2>${col}</h2>`;
      malla.appendChild(div);
      colMap[col] = div;
    });

    materias.forEach(m => {
      const requisitosOk = m.requisitos.every(r => aprobadas.includes(r));
      const div = document.createElement('div');
      div.className = "materia";
      div.textContent = m.nombre;

      if (aprobadas.includes(m.id)) {
        div.classList.add('aprobada');
      } else if (requisitosOk) {
        div.classList.add('desbloqueada');
      } else {
        div.classList.add('bloqueada');
      }

      div.addEventListener('click', () => {
        if (div.classList.contains('bloqueada')) return;

        if (aprobadas.includes(m.id)) {
          aprobadas.splice(aprobadas.indexOf(m.id), 1);
        } else {
          aprobadas.push(m.id);
        }
        guardarProgreso();
        crearMalla();
      });

      colMap[m.columna].appendChild(div);
    });
  }

  crearMalla();
</script>
</body>
</html>
